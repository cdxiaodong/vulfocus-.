phpmailer 文件读取 （CVE-2017-5223）

描述: PHPMailer在发送邮件的过程中，会在邮件内容中寻找图片标签（<img src="...">），并将其src属性的值提取出来作为附件。所以，如果我们能控制部分邮件内容，可以利用<img src="/etc/passwd">将文件/etc/passwd作为附件读取出来，造成任意文件读取漏洞。



影响版本

PHPMailer <= 5.2.21

漏洞复现

意见反馈”页面，正常用户填写昵称、邮箱、意见提交，这些信息将被后端储存，同时后端会发送一封邮件提示用户意见填写完成：

该场景在实战中很常见，比如用户注册网站成功后，通常会收到一封包含自己昵称的通知邮件，那么，我们在昵称中插入恶意代码`<img src="/etc/passwd">`，目标服务器上的文件将以附件的形式被读取出来。
1
我们填写恶意代码在“意见”的位置：

<img src="/etc/passwd">

![image-20211118203012614](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211118203012614.png)

![image-20211118203140985](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211118203140985.png)

